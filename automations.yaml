- id: '1755668156778'
  alias: Driveway - Smooth Sunset Fade
  description: Gradually fade in driveway lights starting 15 minutes before sunset
  triggers:
  - trigger: sun
    event: sunset
    offset: -00:15:00
  actions:
  - target:
      entity_id:
      - light.driveway_driveway_light
    data:
      brightness_pct: 50
      transition: 900
    action: light.turn_on
  mode: single
- id: '1755668333675'
  alias: Driveway - Smooth Sunrise Fade Out
  description: Gradually fade out driveway lights starting 15 minutes after sunrise
  triggers:
  - trigger: sun
    event: sunrise
    offset: 00:15:00
  actions:
  - target:
      entity_id:
      - light.driveway_driveway_light
    data:
      transition: 900
    action: light.turn_off
  mode: single
- id: security_lights_activate
  alias: Security Lights - Person/Vehicle Detected
  description: Activate security lighting when person or vehicle detected during night
    hours
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.driveway_af_person_detected
    - binary_sensor.driveway_af_vehicle_detected
    - binary_sensor.driveway_cdv_person_detected
    - binary_sensor.driveway_cdv_vehicle_detected
    - binary_sensor.g4_pro_person_detected
    - binary_sensor.g4_pro_vehicle_detected
    - binary_sensor.g4_doorbell_person_detected
    - binary_sensor.g4_doorbell_vehicle_detected
    to: 'on'
  conditions:
  - condition: sun
    after: sunset
    before: sunrise
  actions:
  - choose:
    - conditions:
      - condition: state
        entity_id: timer.security_lights_timer
        state: idle
      sequence:
      - data:
          scene_id: security_lights_restore
          snapshot_entities:
          - light.driveway
          - light.front_porch_1
          - light.front_porch_2
          - light.front_porch_3
          - light.back_door_lantern
        action: scene.create
      - target:
          entity_id:
          - light.driveway_driveway_light
        data:
          brightness_pct: 80
          transition: 5
        action: light.turn_on
      - target:
          entity_id:
          - light.front_porch_1
          - light.front_porch_2
          - light.front_porch_3
          - light.back_door_lantern
        data:
          brightness_pct: 100
          transition: 5
        action: light.turn_on
  - target:
      entity_id: timer.security_lights_timer
    action: timer.start
  mode: restart
- id: security_lights_reset
  alias: Security Lights - Reset After Timer
  description: Restore lights to original state after 5 minutes of no activity
  triggers:
  - trigger: event
    event_type: timer.finished
    event_data:
      entity_id: timer.security_lights_timer
  actions:
  - service: scene.turn_on
    target:
      entity_id: scene.security_lights_restore
    data:
      transition: 5
  - service: scene.delete
    target:
      entity_id: scene.security_lights_restore
  mode: single
- id: '1761466432472'
  alias: Water Closet Switch
  description: ''
  use_blueprint:
    path: jax/inovelli_hue.yaml
    input:
      controller: c3a304139f53a04585554e69356b40a0
      target_light: light.hue_color_downlight_1_3
      onoff_transition_number: number.main_bathroom_water_closet_switch_on_off_transition_time
      switch_level_entity: light.main_bathroom_water_closet_switch
- id: '1731916800000'
  alias: Main Bathroom Switch
  description: ''
  use_blueprint:
    path: jax/inovelli_hue.yaml
    input:
      controller: 0d0e7c87550b66a1c07df4344ce9349e
      target_light: light.main_bathroom_vanity
      onoff_transition_number: number.bathroom_on_off_transition_time
      switch_level_entity: light.bathroom
- id: '1731916800001'
  alias: Main Bathroom Perifo Switch
  description: ''
  use_blueprint:
    path: jax/inovelli_hue.yaml
    input:
      controller: 3f1f8dfa89f98cb2c60583343be18116
      target_light: light.main_bathroom_perifo
      onoff_transition_number: number.inovelli_vzm31_sn_on_off_transition_time
      switch_level_entity: light.inovelli_vzm31_sn
- id: '1731916800002'
  alias: Main Bedroom Switch (Primary)
  description: ''
  use_blueprint:
    path: jax/inovelli_hue.yaml
    input:
      controller: a4725fafbb5c890f438fdbb217e5a065
      target_light: light.main_bedroom_lights
      onoff_transition_number: number.bedroom_on_off_transition_time
      switch_level_entity: light.bedroom
- id: '1731916800003'
  alias: Main Bedroom Switch (Secondary)
  description: ''
  use_blueprint:
    path: jax/inovelli_hue.yaml
    input:
      controller: 239dc029b9f00153b39c5de09bbbb95a
      target_light: light.main_bedroom_lights
      onoff_transition_number: number.bedroom_secondary_on_off_transition_time
      switch_level_entity: light.bedroom_secondary
- id: '1731916800004'
  alias: Main Closet Switch
  description: ''
  use_blueprint:
    path: jax/inovelli_hue.yaml
    input:
      controller: 412a521173c99cf910da6d89f4914475
      target_light: light.main_closet
      onoff_transition_number: number.closet_lights_on_off_transition_time
      switch_level_entity: light.closet_lights
- id: '1731916800005'
  alias: Bedroom Door Switch
  description: ''
  use_blueprint:
    path: jax/inovelli_hue.yaml
    input:
      controller: 1e966c43e80dfef9fa3847bea99dff45
      target_light: light.dymera_lights
      onoff_transition_number: number.bedroom_door_on_off_transition_time
      switch_level_entity: light.bedroom_door

# Sensor-triggered chore tasks
- id: chore_water_fountain_low
  alias: "Chore - Water fountain low"
  description: Create task when water fountain needs refilling
  triggers:
    - trigger: state
      entity_id: binary_sensor.eversweet_3_pro_water_lack_warning
      to: "on"
  conditions:
    - condition: not
      conditions:
        - condition: state
          entity_id: todo.household_chores
          attribute: items
          value: "Refill water fountain"
  actions:
    - action: todo.add_item
      target:
        entity_id: todo.household_chores
      data:
        item: "Refill water fountain"
  mode: single

- id: chore_water_fountain_filter
  alias: "Chore - Water fountain filter"
  description: Create task when fountain filter needs replacement
  triggers:
    - trigger: state
      entity_id: binary_sensor.eversweet_3_pro_replace_filter
      to: "on"
  actions:
    - action: todo.add_item
      target:
        entity_id: todo.household_chores
      data:
        item: "Replace fountain filter"
  mode: single

- id: chore_cat_food_low_hopper1
  alias: "Chore - Cat food low (hopper 1)"
  description: Create task when feeder hopper 1 is low
  triggers:
    - trigger: state
      entity_id: binary_sensor.shadow_feeder_food_level_hopper_1
      to: "off"
  actions:
    - action: todo.add_item
      target:
        entity_id: todo.household_chores
      data:
        item: "Refill cat food (hopper 1)"
  mode: single

- id: chore_cat_food_low_hopper2
  alias: "Chore - Cat food low (hopper 2)"
  description: Create task when feeder hopper 2 is low
  triggers:
    - trigger: state
      entity_id: binary_sensor.shadow_feeder_food_level_hopper_2
      to: "off"
  actions:
    - action: todo.add_item
      target:
        entity_id: todo.household_chores
      data:
        item: "Refill cat food (hopper 2)"
  mode: single

- id: chore_feeder_desiccant
  alias: "Chore - Feeder desiccant low"
  description: Create task when feeder desiccant needs replacement
  triggers:
    - trigger: numeric_state
      entity_id: sensor.shadow_feeder_desiccant_left_days
      below: 3
  actions:
    - action: todo.add_item
      target:
        entity_id: todo.household_chores
      data:
        item: "Replace feeder desiccant"
  mode: single

# NFC tag automations for clearing tasks
# Set tag_id after scanning tags with HA Companion app
- id: nfc_clear_litter_box
  alias: "NFC - Clear litter box task"
  description: Mark litter box task complete when NFC tag scanned
  triggers:
    - trigger: tag
      tag_id: "REPLACE_WITH_LITTER_BOX_TAG_ID"
  actions:
    - action: todo.update_item
      target:
        entity_id: todo.household_chores
      data:
        item: "Replace litter"
        status: completed
    - action: todo.update_item
      target:
        entity_id: todo.household_chores
      data:
        item: "Replace litter pad"
        status: completed
  mode: single

- id: nfc_clear_trash
  alias: "NFC - Clear trash task"
  description: Mark trash task complete when NFC tag scanned
  triggers:
    - trigger: tag
      tag_id: "REPLACE_WITH_TRASH_TAG_ID"
  actions:
    - action: todo.update_item
      target:
        entity_id: todo.household_chores
      data:
        item: "Take trash to street"
        status: completed
  mode: single
